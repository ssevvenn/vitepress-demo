import{_ as s,o as a,c as n,U as l}from"./chunks/framework.e5d16f40.js";const i=JSON.parse('{"title":"","description":"","frontmatter":{"prev":false,"next":false},"headers":[],"relativePath":"markdown/chapter-8/chapter-8.2.5/index.md","filePath":"markdown/chapter-8/chapter-8.2.5/index.md"}'),o={name:"markdown/chapter-8/chapter-8.2.5/index.md"},p=l(`<h3 id="datadelete" tabindex="-1">DataDelete <a class="header-anchor" href="#datadelete" aria-label="Permalink to &quot;DataDelete&quot;">​</a></h3><p>用于进行结构数据删除的操作对象。</p><h4 id="构造函数" tabindex="-1">构造函数 <a class="header-anchor" href="#构造函数" aria-label="Permalink to &quot;构造函数&quot;">​</a></h4><h5 id="datadelete-frontend-string" tabindex="-1">DataDelete (Frontend, String) <a class="header-anchor" href="#datadelete-frontend-string" aria-label="Permalink to &quot;DataDelete (Frontend, String)&quot;">​</a></h5><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDelete</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> frontendServer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>frontendServer Frontend</p><p>前置节点服务器对象。</p><p>businessDomainID String</p><p>设置要访问的业务域标识。初始化时可以为空，后续可通过bizDomain属性赋值。businessDomainID在提交数据删除前必须赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//初始化前置节点对象（即链上操作发送对象）</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--业务系统数字身份标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> systemID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0d64ad368ebc37ddb80424376408cb7bb88ff328</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--业务系统数字身份私钥</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> systemPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8d0422cca53480c6b8d0422cca5341a948e91c50c915a4576c88b53de9c473cc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--前置节点调用接口地址</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> frontendUrl </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://127.1.1.1:9000/fbs/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//创建前置节点对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> oFrontend </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Frontend</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">systemID</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> systemPrivateKey</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> frontendUrl</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//设置要访问的业务域标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> businessDomainID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">51eb48b51eb48b2896288021b73bac878c48b289</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">DataDelete</span><span style="color:#A6ACCD;"> oDataDelete </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDelete</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">oFrontend</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="datadelete-1" tabindex="-1">DataDelete() <a class="header-anchor" href="#datadelete-1" aria-label="Permalink to &quot;DataDelete()&quot;">​</a></h5><p>构造一个DataDelete对象。后续需赋值要访问前置节点对象和要访问的业务域。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDelete</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">();</span></span></code></pre></div><h4 id="属性" tabindex="-1">属性 <a class="header-anchor" href="#属性" aria-label="Permalink to &quot;属性&quot;">​</a></h4><h5 id="frontend" tabindex="-1">frontend <a class="header-anchor" href="#frontend" aria-label="Permalink to &quot;frontend&quot;">​</a></h5><p>设置要访问的前置节点服务器对象。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> frontend </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="bizdomain" tabindex="-1">bizDomain <a class="header-anchor" href="#bizdomain" aria-label="Permalink to &quot;bizDomain&quot;">​</a></h5><p>设置要删除数据的链上业务域的唯一标识。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> bizDomain </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="dataid" tabindex="-1">dataID <a class="header-anchor" href="#dataid" aria-label="Permalink to &quot;dataID&quot;">​</a></h5><p>设置要删除的链上数据的数据链上ID。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataID </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="ownerid" tabindex="-1">ownerID <a class="header-anchor" href="#ownerid" aria-label="Permalink to &quot;ownerID&quot;">​</a></h5><p>设置数据所有者的数字身份标识。只有数据所有者才有权提交数据删除。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> ownerID </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="eventcontext" tabindex="-1">eventContext <a class="header-anchor" href="#eventcontext" aria-label="Permalink to &quot;eventContext&quot;">​</a></h5><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> eventContext </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//要删除的数据在链外应用系统数据库中的唯一标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">57bee7e51eb48b2896288021b7374cfc78c0bac8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    oDataDelete</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">eventContext </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">dataIDFromCaller</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h4 id="方法" tabindex="-1">方法 <a class="header-anchor" href="#方法" aria-label="Permalink to &quot;方法&quot;">​</a></h4><h5 id="submit" tabindex="-1">submit <a class="header-anchor" href="#submit" aria-label="Permalink to &quot;submit&quot;">​</a></h5><p>向指定的前置节点服务器提交&quot;数据删除&quot;上链交易请求。调用此方法，将会通过onTxBlockConfirm、onTxSendSuccess等事件返回链上处理结果。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">submit</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> ownerPrivateKey</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>ownerPrivateKey String</p><p>设置要删除的链上数据所有者的数字身份私钥，ownerID对应的私钥。私钥用于对&quot;数据删除&quot;上链交易进行签名确权。</p><p><strong>示例：</strong></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//--链上数据所有者数字身份私钥</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> ownerPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8d0422cca53480c6b8d0422cca5341a948e91c50c915a4576c88b53de9c473cc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//进行数据删除上链操作提交</span></span>
<span class="line"><span style="color:#A6ACCD;">    oDataDelete</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">submit</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ownerPrivateKey</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="createtxbody" tabindex="-1">createTxBody <a class="header-anchor" href="#createtxbody" aria-label="Permalink to &quot;createTxBody&quot;">​</a></h5><p>和前置节点进行交互，生成&quot;数据删除&quot;链上操作对应的上链交易体，以便使用ownerID中数字身份对应的私钥对上链交易体进行确权签名。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createTxBody</span><span style="color:#89DDFF;">();</span></span></code></pre></div><p><strong>返回</strong></p><p>String</p><p>序列化的&quot;数据删除&quot;上链交易体。</p><p><strong>示例：</strong></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//生成&quot;数据删除&quot;上链交易体</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataDeleteTxBody</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> oDataDelete</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createTxBody</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//用数据所有者数字身份对&quot;数据删除&quot;上链交易体进行签名</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> ownerPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3161be862236ae966004390908a5facb8f45763e38ce5cfb378e493f91a7873d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--对&quot;数据删除&quot;上链交易体进行签名，并生成签名结果</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> txSign </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CryptoUtil</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">crypto</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">signature</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dataDeleteTxBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> ownerPrivateKey</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="submittxbody" tabindex="-1">submitTxBody <a class="header-anchor" href="#submittxbody" aria-label="Permalink to &quot;submitTxBody&quot;">​</a></h5><p>使用数据删除上链交易体原文和ownerID中数字身份对上链交易体的签名结果信息，向指定的前置节点服务器提交&quot;数据删除&quot;上链交易请求。调用此方法，将会通过onTxBlockConfirm、onTxSendSuccess等事件返回链上处理结果。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">submitTxBody</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataDeleteTxBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> txSign</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>dataDeleteTxBody String</p><p>数据删除上链交易体原文</p><p>txSign String</p><p>数据删除上链交易体签名结果信息</p><p><strong>示例：</strong></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//【程序A】准备数据删除上链交易体</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">DataDelete</span><span style="color:#A6ACCD;"> oPrepareDataDeleteTxBody </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDelete</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    oPrepareDataDeleteTxBody</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dataID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">88021b73bac8b248b2896278c04a4378962e51eb</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    oPrepareDataDeleteTxBody</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ownerID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0d64ad368ebc37ddb80424376408cb7bb88ff328</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataDeleteTxBody </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> oPrepareDataDeleteTxBody</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createTxBody</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//【程序B】在外部使用数字身份签名应用进行dataDeleteTxBody签名</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> ownerPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3161be862236ae966004390908a5facb8f45763e38ce5cfb378e493f91a7873d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> txSign </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CryptoUtil</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">crypto</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">signature</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dataDeleteTxBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> ownerPrivateKey</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//【程序A】提交数据删除上链交易，并跟踪链上处理状态</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">DataDelete</span><span style="color:#A6ACCD;"> oDataDelete </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDelete</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">frontendServer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    oDataDelete</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">eventContext </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">dataIDFromCaller</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> oDataTxStatus </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> oDataDelete</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">submitTxBody</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dataDeleteTxBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> txSign</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h4 id="事件" tabindex="-1">事件 <a class="header-anchor" href="#事件" aria-label="Permalink to &quot;事件&quot;">​</a></h4><h5 id="ontxblockconfirm" tabindex="-1">onTxBlockConfirm <a class="header-anchor" href="#ontxblockconfirm" aria-label="Permalink to &quot;onTxBlockConfirm&quot;">​</a></h5><p>此事件在数据删除上链交易执行成功，并获得落块确认时发生。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxBlockConfirm</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>dDeleteStatus DataTxStatus</p><p>包含&quot;数据删除&quot;上链交易的当前处理状态信息的对象。</p><p>dDeleteStatus中将包含如下返回信息，详细解释请参看DataTxStatus对象相关描述：</p><p>| status，errorCode，message，dataID，txHash，txExecTimestamp，blockHash，blockedTimestamp，blockHeight |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataDelete</span><span style="color:#A6ACCD;"> oDataDelete </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDelete</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxBlockConfirm</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">dDeleteStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：数据删除上链交易执行成功，并获得落块确认。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">DataTxBlockInfo</span><span style="color:#A6ACCD;"> oDataTxBlockInfo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txBlockData</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">数据链上ID =</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dataID</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dataIDFromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="ontxblkcfmfailure" tabindex="-1">onTxBlkCfmFailure <a class="header-anchor" href="#ontxblkcfmfailure" aria-label="Permalink to &quot;onTxBlkCfmFailure&quot;">​</a></h5><p>此事件在数据删除上链交易落块确认失败，删除状态变更被链回滚时发生。事件触发后，会返回错误信息。数据删除上链交易需重新提交。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxBlockCfmFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>dDeleteStatus DataTxStatus</p><p>包含&quot;数据删除&quot;上链交易的当前处理状态信息的对象。</p><p>dDeleteStatus中将包含如下返回信息，详细解释请参看DataTxStatus对象相关描述：</p><p>| status，errorCode，message，txHash，txExecTimestamp，blockHash，blockedTimestamp，blockHeight |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataDelete</span><span style="color:#A6ACCD;"> oDataDelete </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDelete</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxBlockCfmFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">dDeleteStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：数据删除上链交易落块确认失败，删除状态变更被链回滚。</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发后，会返回错误信息。数据删除上链交易请求需重新提交。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dataIDFromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">DataTxBlockInfo</span><span style="color:#A6ACCD;"> oDataTxBlockInfo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txBlockData</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">数据删除上链交易Hash =</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txHash</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">数据删除上链交易落块确认失败的返回结果=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="ontxsendsuccess" tabindex="-1">onTxSendSuccess <a class="header-anchor" href="#ontxsendsuccess" aria-label="Permalink to &quot;onTxSendSuccess&quot;">​</a></h5><p>此事件在数据删除上链交易发送成功，等待区块链执行处理时发生。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxSendSuccess</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>dDeleteStatus DataTxStatus</p><p>包含&quot;数据删除&quot;上链交易的当前处理状态信息的对象。</p><p>dDeleteStatus中将包含如下返回信息，详细解释请参看DataTxStatus对象相关描述：</p><p>| status，errorCode，message，txHash |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataDelete</span><span style="color:#A6ACCD;"> oDataDelete </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDelete</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxSendSuccess</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">dDeleteStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：数据删除上链交易发送成功，等待区块链执行处理。 </span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">DataTxBlockInfo</span><span style="color:#A6ACCD;"> oDataTxBlockInfo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txBlockData</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">数据删除上链交易Hash =</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txHash</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="ontxsendfailure" tabindex="-1">onTxSendFailure <a class="header-anchor" href="#ontxsendfailure" aria-label="Permalink to &quot;onTxSendFailure&quot;">​</a></h5><p>此事件在数据删除上链交易发送失败时发生。数据删除上链交易需重新提交。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxSendFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>dDeleteStatus DataTxStatus</p><p>包含&quot;数据删除&quot;上链交易的当前处理状态信息的对象。</p><p>dDeleteStatus中将包含如下返回信息，详细解释请参看DataTxStatus对象相关描述：</p><p>| errorCode，message |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataDelete</span><span style="color:#A6ACCD;"> oDataDelete </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDelete</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxSendFailure</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">dDeleteStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：数据删除上链交易发送失败。</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发后，会返回错误信息。</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">数据删除上链交易发送失败的返回结果=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="ontxexecsuccess" tabindex="-1">onTxExecSuccess <a class="header-anchor" href="#ontxexecsuccess" aria-label="Permalink to &quot;onTxExecSuccess&quot;">​</a></h5><p>此事件在数据删除上链交易执行成功，等待落块确认时发生。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxExecSuccess</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>dDeleteStatus DataTxStatus</p><p>包含&quot;数据删除&quot;上链交易的当前处理状态信息的对象。</p><p>dDeleteStatus中将包含如下返回信息，详细解释请参看DataTxStatus对象相关描述：</p><p>| status，errorCode，message，dataID，txHash，txExecTimestamp，blockHash，blockedTimestamp，blockHeight |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataDelete</span><span style="color:#A6ACCD;"> oDataDelete </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDelete</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxExecSuccess</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">dDeleteStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：数据删除上链交易执行成功，等待落块确认。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">DataTxBlockInfo</span><span style="color:#A6ACCD;"> oDataTxBlockInfo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txBlockData</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dataIDFromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">数据链上ID =</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dataID</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">数据删除上链交易Hash=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txHash</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">交易执行时间戳=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txExecTimestamp</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">交易所在区块hash=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">blockHash</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">交易所在区块生成时间戳</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">blockedTimestamp</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">交易所在区块高度=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">blockHeight</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="ontxexecfailure" tabindex="-1">onTxExecFailure <a class="header-anchor" href="#ontxexecfailure" aria-label="Permalink to &quot;onTxExecFailure&quot;">​</a></h5><p>此事件在数据删除上链交易执行失败，删除状态变更未在链上生效时发生。事件触发后会返回错误信息。数据删除上链交易需重新提交。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxExecFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> dDeleteStatus </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>dDeleteStatus DataTxStatus</p><p>包含&quot;数据删除&quot;上链交易的当前处理状态信息的对象。</p><p>dDeleteStatus中将包含如下返回信息，详细解释请参看DataTxStatus对象相关描述：</p><p>| status，errorCode，message，txHash，txExecTimestamp，blockHash，blockedTimestamp，blockHeight |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataDelete</span><span style="color:#A6ACCD;"> oDataDelete </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDelete</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxExecFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataTxStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">dDeleteStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：数据删除上链交易执行失败，删除状态变更未在链上生效。 </span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发后，会返回错误信息。删除状态变更上链交易请求需重新提交。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">DataTxBlockInfo</span><span style="color:#A6ACCD;"> oDataTxBlockInfo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txBlockData</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dataIDFromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">数据链上ID =</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dataID</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">删除状态变更上链交易Hash=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txHash</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">交易执行时间戳=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txExecTimestamp</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">交易所在区块hash=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">blockHash</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">交易所在区块生成时间戳</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">blockedTimestamp</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">交易所在区块高度=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">blockHeight</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链上执行失败的返回结果=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dDeleteStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="onerror" tabindex="-1">onError <a class="header-anchor" href="#onerror" aria-label="Permalink to &quot;onError&quot;">​</a></h5><p>此为事件在DataDelete调用出现异常时发生。事件触发后返回异常信息。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onError</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">TxException</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataDelete</span><span style="color:#A6ACCD;"> oDataDelete </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDelete</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onError</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">TxException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">e</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：DataDelete调用出现异常。并返回异常信息。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dataIDFromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">异常状态描述=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">异常信息=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">exc</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h4 id="datatxstatus-status状态编码" tabindex="-1">DataTxStatus.status状态编码 <a class="header-anchor" href="#datatxstatus-status状态编码" aria-label="Permalink to &quot;DataTxStatus.status状态编码&quot;">​</a></h4><p>状态编码列表：</p><table><thead><tr><th>状态取值</th><th>描述</th><th>备注</th></tr></thead><tbody><tr><td>TxSendSuccess</td><td>上链交易发送成功。</td><td>节点确认接收数据删除上链交易请求，等待区块链执行处理。</td></tr><tr><td>TxSendFailure</td><td>上链交易发送失败。</td><td>节点接收数据删除上链交易请求失败，数据删除上链交易请求需重新提交。</td></tr><tr><td>TxExecSuccess</td><td>上链交易执行成功。</td><td>数据删除上链交易执行成功，等待落块确认。</td></tr><tr><td>TxExecFailure</td><td>上链交易执行失败。</td><td>数据删除上链交易执行失败，删除状态变更未在链上生效。数据删除上链交易请求需重新提交。</td></tr><tr><td>TxBlockConfirm</td><td>上链交易落块确认。</td><td>数据删除上链交易执行成功，并获得落块确认</td></tr><tr><td>TxBlkCfmFailure</td><td>上链交易落块确认失败。</td><td>因落块确认失败，删除状态变更被链回滚。数据删除上链交易请求需重新提交。</td></tr></tbody></table><h3 id="datadigestcheck" tabindex="-1">DataDigestCheck <a class="header-anchor" href="#datadigestcheck" aria-label="Permalink to &quot;DataDigestCheck&quot;">​</a></h3><p>用于进行链上结构数据体验真的操作对象。</p><h4 id="构造函数-1" tabindex="-1">构造函数 <a class="header-anchor" href="#构造函数-1" aria-label="Permalink to &quot;构造函数&quot;">​</a></h4><h5 id="datadigestcheck-frontend-string" tabindex="-1">DataDigestCheck (Frontend, String) <a class="header-anchor" href="#datadigestcheck-frontend-string" aria-label="Permalink to &quot;DataDigestCheck (Frontend, String)&quot;">​</a></h5><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDigestCheck</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> frontendServer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>frontendServer Frontend</p><p>前置节点服务器对象。</p><p>businessDomainID String</p><p>设置要访问的业务域标识。初始化时可以为空，后续可通过bizDomain属性赋值。businessDomainID在提交链上查询请求前必须赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//初始化前置节点对象（即链上操作发送对象）</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--业务系统数字身份标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> systemID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0d64ad368ebc37ddb80424376408cb7bb88ff328</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--业务系统数字身份私钥</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> systemPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8d0422cca53480c6b8d0422cca5341a948e91c50c915a4576c88b53de9c473cc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--前置节点调用接口地址</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> frontendUrl </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://127.1.1.1:9000/fbs/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//创建前置节点对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> oFrontend </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Frontend</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">systemID</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> systemPrivateKey</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> frontendUrl</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//设置要访问的业务域标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> businessDomainID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">51eb48b51eb48b2896288021b73bac878c48b289</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">DataDigestCheck</span><span style="color:#A6ACCD;"> oDataDigestCheck </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDigestCheck</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">oFrontend</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="datadigestcheck-1" tabindex="-1">DataDigestCheck () <a class="header-anchor" href="#datadigestcheck-1" aria-label="Permalink to &quot;DataDigestCheck ()&quot;">​</a></h5><p>构造一个DataDigestCheck对象。后续需赋值要访问前置节点对象和要访问的业务域。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataDigestCheck</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">();</span></span></code></pre></div><h4 id="属性-1" tabindex="-1">属性 <a class="header-anchor" href="#属性-1" aria-label="Permalink to &quot;属性&quot;">​</a></h4><h5 id="frontend-1" tabindex="-1">frontend <a class="header-anchor" href="#frontend-1" aria-label="Permalink to &quot;frontend&quot;">​</a></h5><p>设置要访问的前置节点服务器对象。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> frontend </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="bizdomain-1" tabindex="-1">bizDomain <a class="header-anchor" href="#bizdomain-1" aria-label="Permalink to &quot;bizDomain&quot;">​</a></h5><p>设置要进行数据验真的结构数据所在链上业务域的唯一标识。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> bizDomain </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="dataid-1" tabindex="-1">dataID <a class="header-anchor" href="#dataid-1" aria-label="Permalink to &quot;dataID&quot;">​</a></h5><p>设置要进行数据验真的链上数据的数据链上ID。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataID </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="versionid" tabindex="-1">versionID <a class="header-anchor" href="#versionid" aria-label="Permalink to &quot;versionID&quot;">​</a></h5><p>设置要验证的链上数据指定版本的数据版本ID。如果此属性不赋值，则默认是和链上数据的最新版本（即当前版本）的数据指纹特征信息进行验证。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> versionID </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="datadigest" tabindex="-1">dataDigest <a class="header-anchor" href="#datadigest" aria-label="Permalink to &quot;dataDigest&quot;">​</a></h5><p>本地结构数据体指纹特征值，用于验证本地结构数据是否和链上结构数据的特定版本的结构数据体一致，是否被篡改过。结构数据体内容如有任何微小的变化，对应的指纹特征值就会发生变化。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataDigest </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h4 id="方法-1" tabindex="-1">方法 <a class="header-anchor" href="#方法-1" aria-label="Permalink to &quot;方法&quot;">​</a></h4><h5 id="query" tabindex="-1">query <a class="header-anchor" href="#query" aria-label="Permalink to &quot;query&quot;">​</a></h5><p>以同步调用方式，向指定的前置节点服务器提交&quot;数据验真&quot;链上查询请求，开始进行数据验真链上操作。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DataDigestCheckStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">query</span><span style="color:#89DDFF;">();</span></span></code></pre></div><p><strong>返回</strong></p><p>DataDigestCheckStatus</p><p>包含&quot;数据验真&quot;链上操作的查询结果信息。</p><h3 id="dataversionsfetch" tabindex="-1">DataVersionsFetch <a class="header-anchor" href="#dataversionsfetch" aria-label="Permalink to &quot;DataVersionsFetch&quot;">​</a></h3><p>用于进行链上结构数据历史版本列表获取的操作对象。</p><h4 id="构造函数-2" tabindex="-1">构造函数 <a class="header-anchor" href="#构造函数-2" aria-label="Permalink to &quot;构造函数&quot;">​</a></h4><h5 id="dataversionsfetch-frontend-string" tabindex="-1">DataVersionsFetch (Frontend, String) <a class="header-anchor" href="#dataversionsfetch-frontend-string" aria-label="Permalink to &quot;DataVersionsFetch (Frontend, String)&quot;">​</a></h5><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataVersionsFetch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> frontendServer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>frontendServer Frontend</p><p>前置节点服务器对象。</p><p>businessDomainID String</p><p>设置要访问的业务域标识。初始化时可以为空，后续可通过bizDomain属性赋值。businessDomainID在提交链上获取请求前必须赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//初始化前置节点对象（即链上操作发送对象）</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--业务系统数字身份标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> systemID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0d64ad368ebc37ddb80424376408cb7bb88ff328</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--业务系统数字身份私钥</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> systemPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8d0422cca53480c6b8d0422cca5341a948e91c50c915a4576c88b53de9c473cc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--前置节点调用接口地址</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> frontendUrl </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://127.1.1.1:9000/fbs/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//创建前置节点对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> oFrontend </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Frontend</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">systemID</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> systemPrivateKey</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> frontendUrl</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//设置要访问的业务域标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> businessDomainID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">51eb48b51eb48b2896288021b73bac878c48b289</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">DataVersionsFetch</span><span style="color:#A6ACCD;"> oDataVerFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataVersionsFetch</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">oFrontend</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="dataversionsfetch-1" tabindex="-1">DataVersionsFetch () <a class="header-anchor" href="#dataversionsfetch-1" aria-label="Permalink to &quot;DataVersionsFetch ()&quot;">​</a></h5><p>构造一个DataVersionsFetch对象。后续需赋值要访问前置节点对象和要访问的业务域。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataVersionsFetch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">();</span></span></code></pre></div><h4 id="属性-2" tabindex="-1">属性 <a class="header-anchor" href="#属性-2" aria-label="Permalink to &quot;属性&quot;">​</a></h4><h5 id="frontend-2" tabindex="-1">frontend <a class="header-anchor" href="#frontend-2" aria-label="Permalink to &quot;frontend&quot;">​</a></h5><p>设置要访问的前置节点服务器对象。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> frontend </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="bizdomain-2" tabindex="-1">bizDomain <a class="header-anchor" href="#bizdomain-2" aria-label="Permalink to &quot;bizDomain&quot;">​</a></h5><p>设置要获取数据版本列表的结构数据所在链上业务域的唯一标识。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> bizDomain </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="dataid-2" tabindex="-1">dataID <a class="header-anchor" href="#dataid-2" aria-label="Permalink to &quot;dataID&quot;">​</a></h5><p>设置要获取数据版本列表的链上结构数据的数据链上ID。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataID </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="fetcherid" tabindex="-1">fetcherID <a class="header-anchor" href="#fetcherid" aria-label="Permalink to &quot;fetcherID&quot;">​</a></h5><p>设置要获取数据版本列表的获取者数字身份标识。数据获取者必须拥有数据读取权，owners、sharers、readers中的一个数字身份标识。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> fetcherID </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="eventcontext-1" tabindex="-1">eventContext <a class="header-anchor" href="#eventcontext-1" aria-label="Permalink to &quot;eventContext&quot;">​</a></h5><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> eventContext </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//要获取数据版本列表的数据在链外应用系统数据库中的唯一标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">57bee7e51eb48b2896288021b7374cfc78c0bac8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    DataVersionsFetch</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">eventContext </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">dataIDFromCaller</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h4 id="方法-2" tabindex="-1">方法 <a class="header-anchor" href="#方法-2" aria-label="Permalink to &quot;方法&quot;">​</a></h4><h5 id="query-1" tabindex="-1">query <a class="header-anchor" href="#query-1" aria-label="Permalink to &quot;query&quot;">​</a></h5><p>向指定的前置节点服务器提交&quot;数据版本列表获取&quot;链上获取请求。调用此方法，将会通过onSuccess 和onFailure事件返回查询结果。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">query</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> fetcherPrivateKey</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>fetcherPrivateKey String</p><p>设置要进行数据版本列表获取的获取者数字身份私钥，fetcherID对应的私钥。私钥用于对&quot;数据版本列表获取&quot;链上获取请求进行签名确权。</p><p><strong>示例：</strong></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataVersionsFetch</span><span style="color:#A6ACCD;"> oDataVerFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataVersionsFetch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onSuccess</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataVersionsFetchStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">dVerFetchStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">         </span><span style="color:#676E95;font-style:italic;">//事件触发条件：数据版本列表成功下载。</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//获取者数字身份私钥</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> fetcherPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8d0422cca53480c6b8d0422cca5341a948e91c50c915a4576c88b53de9c473cc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//进行&quot;数据版本列表获取&quot;链上操作提交</span></span>
<span class="line"><span style="color:#A6ACCD;">    oDataVerFetch</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">fetcherPrivateKey</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="createrqbody" tabindex="-1">createRqBody <a class="header-anchor" href="#createrqbody" aria-label="Permalink to &quot;createRqBody&quot;">​</a></h5><p>和前置节点进行交互，生成&quot;数据版本列表获取&quot;链上操作对应的链上获取请求体，以便使用fetcherID对应的私钥对链上获取请求体进行确权签名。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createRqBody</span><span style="color:#89DDFF;">();</span></span></code></pre></div><p><strong>返回</strong></p><p>String</p><p>序列化的&quot;数据版本列表获取&quot;链上获取请求体。</p><p><strong>示例：</strong></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//生成&quot;数据版本列表获取&quot;链上获取请求体</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dVerFetchRqBody</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> oDataVersionsFetch</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createRqBody</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//用获取者数字身份对&quot;数据版本列表获取&quot;链上获取请求体进行签名</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> fetcherPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3161be862236ae966004390908a5facb8f45763e38ce5cfb378e493f91a7873d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--对&quot;数据版本列表获取&quot;链上获取请求体进行签名，并生成签名结果</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> txSign </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CryptoUtil</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">crypto</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">signature</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dVerFetchRqBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fetcherPrivateKey</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="queryrqbody" tabindex="-1">queryRqBody <a class="header-anchor" href="#queryrqbody" aria-label="Permalink to &quot;queryRqBody&quot;">​</a></h5><p>使用数据版本列表获取链上获取请求体原文和fetcherID中数字身份对获取请求体的签名结果信息，向指定的前置节点服务器提交&quot;数据版本列表获取&quot;链上获取请求。调用此方法，将会通过onSuccess 和onFailure事件返回查询结果。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">queryRqBody</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dVerFetchRqBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> txSign</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>dVerFetchRqBody String</p><p>数据版本列表获取链上获取请求体原文</p><p>txSign String</p><p>数据版本列表获取链上获取请求体签名结果信息</p><p><strong>示例：</strong></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//【程序A】准备&quot;数据版本列表获取&quot;链上获取请求体</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">DataVersionsFetch</span><span style="color:#A6ACCD;"> oPrepareDVerFetchRqBody </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataVersionsFetch</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    oPrepareDVerFetchRqBody</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dataID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">88021b73bac8b248b2896278c04a4378962e51eb</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    oPrepareDVerFetchRqBody</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fetcherID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0d64ad368ebc37ddb80424376408cb7bb88ff328</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dVerFetchRqBody </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> oPrepareDVerFetchRqBody</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createRqBody</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//【程序B】在外部使用数字身份签名应用进行dVerFetchRqBody签名</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> fetcherPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8d0422cca53480c6b8d0422cca5341a948e91c50c915a4576c88b53de9c473cc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> txSign </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CryptoUtil</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">crypto</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">signature</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dVerFetchRqBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fetcherPrivateKey</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//【程序A】提交&quot;数据版本列表获取&quot;链上获取请求，并跟踪链上处理状态</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">DataVersionsFetch</span><span style="color:#A6ACCD;"> oDataVerFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataVersionsFetch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">frontendServer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    oDataVerFetch</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">eventContext </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">dataIDFromCaller</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    oDataVerFetch</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">queryRqBody</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dVerFetchRqBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> txSign</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h4 id="事件-1" tabindex="-1">事件 <a class="header-anchor" href="#事件-1" aria-label="Permalink to &quot;事件&quot;">​</a></h4><h5 id="onsuccess" tabindex="-1">onSuccess <a class="header-anchor" href="#onsuccess" aria-label="Permalink to &quot;onSuccess&quot;">​</a></h5><p>此事件在&quot;数据版本列表获取&quot;链上操作处理彻底完成，数据版本列表已成功下载时发生。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onSuccess</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataVersionsFetchStatus</span><span style="color:#A6ACCD;"> dVerFetchStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>dVerFetchStatus DataVersionsFetchStatus</p><p>包含&quot;数据获取&quot;链上操作的当前处理状态信息的对象。</p><p>dVerFetchStatus中将包含如下返回信息，详细解释请参看DataVersionsFetchStatus对象相关描述：</p><p>| status，errorCode，message，versions |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataVersionsFetch</span><span style="color:#A6ACCD;"> oDataVersionsFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataVersionsFetch</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onSuccess</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataVersionsFetchStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">dVerFetchStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：&quot;获取数据版本列表&quot;成功下载。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dataIDFromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">DataVersionInfo</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> oDataVersionInfo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dVerFetchStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">versions</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> i</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> i</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> oDataVersionInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> i</span><span style="color:#89DDFF;">++)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">             System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">数据版本标识: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataVersionInfo</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">].</span><span style="color:#A6ACCD;">versionID</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">             System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">数据版本的生成时间戳: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataVersionInfo</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">].</span><span style="color:#A6ACCD;">timestamp</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">             </span><span style="color:#676E95;font-style:italic;">//获取指定版本的结构数据</span></span>
<span class="line"><span style="color:#A6ACCD;">             </span><span style="color:#C792EA;">DataFetch</span><span style="color:#A6ACCD;"> oDataFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataFetch</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">             </span><span style="color:#676E95;font-style:italic;">//指定获取链上数据的数据链上ID。</span></span>
<span class="line"><span style="color:#A6ACCD;">             oDataFetch</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dataID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">21b73bac878c04a437b28962e51eb48b28962880</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">             </span><span style="color:#676E95;font-style:italic;">//指定获取链上数据的数据版本ID。</span></span>
<span class="line"><span style="color:#A6ACCD;">             oDataFetch</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">versionID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> oDataVersionInfo</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">].</span><span style="color:#A6ACCD;">versionID</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">                          </span><span style="color:#89DDFF;">......</span></span>
<span class="line"><span style="color:#89DDFF;">             </span><span style="color:#676E95;font-style:italic;">//进行&quot;获取数据版本列表&quot;上链操作提交</span></span>
<span class="line"><span style="color:#A6ACCD;">             </span><span style="color:#C792EA;">DataFetchStatus</span><span style="color:#A6ACCD;"> oDataFetchStatus </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> oDataFetch</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">fetcherPrivateKey</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="onfailure" tabindex="-1">onFailure <a class="header-anchor" href="#onfailure" aria-label="Permalink to &quot;onFailure&quot;">​</a></h5><p>此事件在&quot;数据版本列表获取&quot;链上操作处理失败，数据版本列表未被下载时发生。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onSuccess</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataVersionsFetchStatus</span><span style="color:#A6ACCD;"> dVerFetchStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>dVerFetchStatus DataVersionsFetchStatus</p><p>包含&quot;数据元数据获取&quot;链上操作的当前处理状态信息的对象。</p><p>dVerFetchStatus中将包含如下返回信息，详细解释请参看DataVersionsFetchStatus对象相关描述：</p><p>| errorCode，message |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataVersionsFetch</span><span style="color:#A6ACCD;"> oDataVersionsFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataVersionsFetch</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataVersionsFetchStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">dVerFetchStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">//事件触发条件：&quot;数据版本列表获取&quot;链上操作处理失败，数据版本列表未被下载。</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">          System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dataIDFromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">          System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">查询失败=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dVerFetchStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="onerror-1" tabindex="-1">onError <a class="header-anchor" href="#onerror-1" aria-label="Permalink to &quot;onError&quot;">​</a></h5><p>此为事件在DataVersionsFetch调用出现异常时发生。事件触发后返回异常信息。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onError</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">FetchException</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataVersionsFetch</span><span style="color:#A6ACCD;"> oDataVersionsFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataVersionsFetch</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onError</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">FetchException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">e</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：DataVersionsFetch调用出现异常。并返回异常信息。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dataIDFromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">异常状态描述=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">异常信息=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">exc</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h3 id="datarightsfetch" tabindex="-1">DataRightsFetch <a class="header-anchor" href="#datarightsfetch" aria-label="Permalink to &quot;DataRightsFetch&quot;">​</a></h3><p>用于进行链上结构数据权限列表获取的操作对象。权限列表包括：所有者列表、分享者列表、读取者列表。</p><ul><li>结构数据所有者有权获取完整的所有者列表和所有者分别授权的读取者列表；完整的分享者列表和分享者分别授权的读取者列表。</li><li>结构数据分享者有权获取自己授权的读取者列表。</li><li>结构数据读取者无权获取结构数据权限列表。</li></ul><h4 id="构造函数-3" tabindex="-1">构造函数 <a class="header-anchor" href="#构造函数-3" aria-label="Permalink to &quot;构造函数&quot;">​</a></h4><h5 id="datarightsfetch-frontend-string" tabindex="-1">DataRightsFetch (Frontend, String) <a class="header-anchor" href="#datarightsfetch-frontend-string" aria-label="Permalink to &quot;DataRightsFetch (Frontend, String)&quot;">​</a></h5><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataRightsFetch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> frontendServer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>frontendServer Frontend</p><p>前置节点服务器对象。</p><p>businessDomainID String</p><p>设置要访问的业务域标识。初始化时可以为空，后续可通过bizDomain属性赋值。businessDomainID在提交链上获取请求前必须赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//初始化前置节点对象（即链上操作发送对象）</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--业务系统数字身份标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> systemID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0d64ad368ebc37ddb80424376408cb7bb88ff328</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--业务系统数字身份私钥</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> systemPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8d0422cca53480c6b8d0422cca5341a948e91c50c915a4576c88b53de9c473cc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--前置节点调用接口地址</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> frontendUrl </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://127.1.1.1:9000/fbs/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//创建前置节点对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> oFrontend </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Frontend</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">systemID</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> systemPrivateKey</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> frontendUrl</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//设置要访问的业务域标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> businessDomainID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">51eb48b51eb48b2896288021b73bac878c48b289</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">DataRightsFetch</span><span style="color:#A6ACCD;"> oDataRightsFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataRightsFetch</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">oFrontend</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="datarightsfetch-1" tabindex="-1">DataRightsFetch () <a class="header-anchor" href="#datarightsfetch-1" aria-label="Permalink to &quot;DataRightsFetch ()&quot;">​</a></h5><p>构造一个DataRightsFetch对象。后续需赋值要访问前置节点对象和要访问的业务域。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataRightsFetch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">();</span></span></code></pre></div><h4 id="属性-3" tabindex="-1">属性 <a class="header-anchor" href="#属性-3" aria-label="Permalink to &quot;属性&quot;">​</a></h4><h5 id="frontend-3" tabindex="-1">frontend <a class="header-anchor" href="#frontend-3" aria-label="Permalink to &quot;frontend&quot;">​</a></h5><p>设置要访问的前置节点服务器对象。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> frontend </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="bizdomain-3" tabindex="-1">bizDomain <a class="header-anchor" href="#bizdomain-3" aria-label="Permalink to &quot;bizDomain&quot;">​</a></h5><p>设置要获取结构数据权限列表的结构数据所在链上业务域的唯一标识。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> bizDomain </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="dataid-3" tabindex="-1">dataID <a class="header-anchor" href="#dataid-3" aria-label="Permalink to &quot;dataID&quot;">​</a></h5><p>设置要获取结构数据权限列表的链上结构数据的结构数据链上ID。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dataID </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="fetcherid-1" tabindex="-1">fetcherID <a class="header-anchor" href="#fetcherid-1" aria-label="Permalink to &quot;fetcherID&quot;">​</a></h5><p>设置要获取结构数据权限列表的获取者数字身份标识，owners、sharers、readers中的一个数字身份标识。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> fetcherID </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="eventcontext-2" tabindex="-1">eventContext <a class="header-anchor" href="#eventcontext-2" aria-label="Permalink to &quot;eventContext&quot;">​</a></h5><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> eventContext </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//要获取结构数据权限列表的结构数据在链外应用系统数据库中的唯一标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> DataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">57bee7e51eb48b2896288021b7374cfc78c0bac8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    DataRightsFetch</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">eventContext </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">DataIDFromCaller</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h4 id="方法-3" tabindex="-1">方法 <a class="header-anchor" href="#方法-3" aria-label="Permalink to &quot;方法&quot;">​</a></h4><h5 id="query-2" tabindex="-1">query <a class="header-anchor" href="#query-2" aria-label="Permalink to &quot;query&quot;">​</a></h5><p>向指定的前置节点服务器提交&quot;结构数据权限列表获取&quot;链上获取请求。调用此方法，将会通过onSuccess 和onFailure事件返回查询结果。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">query</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> fetcherPrivateKey</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>fetcherPrivateKey String</p><p>设置要进行结构数据权限列表获取的获取者数字身份私钥，fetcherID对应的私钥。私钥用于对&quot;结构数据权限列表获取&quot;链上获取请求进行签名确权。</p><p><strong>示例：</strong></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataRightsFetch</span><span style="color:#A6ACCD;"> oDataRightsFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataRightsFetch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onSuccess</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataRightsFetchStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">dRightsFetchStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">         </span><span style="color:#676E95;font-style:italic;">//事件触发条件：结构数据权限列表成功下载。</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//获取者数字身份私钥</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> fetcherPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8d0422cca53480c6b8d0422cca5341a948e91c50c915a4576c88b53de9c473cc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//进行&quot;结构数据权限列表获取&quot;链上操作提交</span></span>
<span class="line"><span style="color:#A6ACCD;">    oDataRightsFetch</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">fetcherPrivateKey</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="createrqbody-1" tabindex="-1">createRqBody <a class="header-anchor" href="#createrqbody-1" aria-label="Permalink to &quot;createRqBody&quot;">​</a></h5><p>和前置节点进行交互，生成&quot;结构数据权限列表获取&quot;链上操作对应的链上获取请求体，以便使用fetcherID对应的私钥对链上获取请求体进行确权签名。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createRqBody</span><span style="color:#89DDFF;">();</span></span></code></pre></div><p><strong>返回</strong></p><p>String</p><p>序列化的&quot;结构数据权限列表获取&quot;链上获取请求体。</p><p><strong>示例：</strong></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//生成&quot;结构数据权限列表获取&quot;链上获取请求体</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dRightsFetchRqBody</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> oDataRightsFetch</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createRqBody</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//用获取者数字身份对&quot;结构数据权限列表获取&quot;链上获取请求体进行签名</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> fetcherPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3161be862236ae966004390908a5facb8f45763e38ce5cfb378e493f91a7873d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--对&quot;结构数据权限列表获取&quot;链上获取请求体进行签名，并生成签名结果</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> txSign </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CryptoUtil</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">crypto</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">signature</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dRightsFetchRqBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fetcherPrivateKey</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="queryrqbody-1" tabindex="-1">queryRqBody <a class="header-anchor" href="#queryrqbody-1" aria-label="Permalink to &quot;queryRqBody&quot;">​</a></h5><p>使用结构数据权限列表获取链上获取请求体原文和fetcherID中数字身份对获取请求体的签名结果信息，向指定的前置节点服务器提交&quot;结构数据权限列表获取&quot;链上获取请求。调用此方法，将会通过onSuccess 和onFailure事件返回查询结果。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">queryRqBody</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dRightsFetchRqBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> txSign</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>dRightsFetchRqBody String</p><p>结构数据权限列表获取链上获取请求体原文</p><p>txSign String</p><p>结构数据权限列表获取链上获取请求体签名结果信息</p><p><strong>示例：</strong></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//【程序A】准备&quot;结构数据权限列表获取&quot;链上获取请求体</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">DataRightsFetch</span><span style="color:#A6ACCD;"> oPrepareDRightsFetchRqBody </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataRightsFetch</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    oPrepareDRightsFetchRqBody</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dataID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">88021b73bac8b248b2896278c04a4378962e51eb</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    oPrepareDRightsFetchRqBody</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fetcherID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0d64ad368ebc37ddb80424376408cb7bb88ff328</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> dRightsFetchRqBody </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> oPrepareDRightsFetchRqBody</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createRqBody</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//【程序B】在外部使用数字身份签名应用进行dRightsFetchRqBody签名</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> fetcherPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8d0422cca53480c6b8d0422cca5341a948e91c50c915a4576c88b53de9c473cc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> txSign </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CryptoUtil</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">crypto</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">signature</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dRightsFetchRqBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fetcherPrivateKey</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//【程序A】提交&quot;结构数据权限列表获取&quot;链上获取请求，并跟踪链上处理状态</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">DataRightsFetch</span><span style="color:#A6ACCD;"> oDataRightsFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataRightsFetch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">frontendServer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    oDataRightsFetch</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">eventContext </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">DataIDFromCaller</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    oDataRightsFetch</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">queryRqBody</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dRightsFetchRqBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> txSign</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h4 id="事件-2" tabindex="-1">事件 <a class="header-anchor" href="#事件-2" aria-label="Permalink to &quot;事件&quot;">​</a></h4><h5 id="onsuccess-1" tabindex="-1">onSuccess <a class="header-anchor" href="#onsuccess-1" aria-label="Permalink to &quot;onSuccess&quot;">​</a></h5><p>此事件在&quot;结构数据权限列表获取&quot;链上操作处理彻底完成，结构数据权限列表已成功下载时发生。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onSuccess</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataRightsFetchStatus</span><span style="color:#A6ACCD;"> dRightsFetchStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>dRightsFetchStatus DataRightsFetchStatus</p><p>包含&quot;结构数据权限列表获取&quot;链上操作的当前处理状态信息的对象。</p><p>dRightsFetchStatus中将包含如下返回信息，详细解释请参看DataRightsFetchStatus对象相关描述：</p><p>| status，errorCode，message，dataRights |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataRightsFetch</span><span style="color:#A6ACCD;"> oDataRightsFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataRightsFetch</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onSuccess</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataRightsFetchStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">dRightsFetchStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：在&quot;获取结构数据权限列表&quot;成功下载。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> DataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> DataIDFromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">DataRightsInfo</span><span style="color:#A6ACCD;"> oDataRightsInfo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dRightsFetchStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dataRights</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> i</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> i</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> oDataRightsInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">owners</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> i</span><span style="color:#89DDFF;">++)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">             System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">结构数据所有者身份标识: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oDataRightsInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">owners</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">]);</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//结构数据所有者所授权的分享者列表 </span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">SharerList</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> oSharersSetByOwner </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dRightsFetchStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">sharersByOwner</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> j</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> j</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> oSharersSetByOwner</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> j</span><span style="color:#89DDFF;">++)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">             System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">有授权分享者的结构数据所有者数字身份标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oSharersSetByOwner</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">j</span><span style="color:#89DDFF;">].</span><span style="color:#A6ACCD;">ownerID</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">             </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> n</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> n</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> oSharersSetByOwner</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">j</span><span style="color:#89DDFF;">].</span><span style="color:#A6ACCD;">sharers</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> n</span><span style="color:#89DDFF;">++)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">当前结构数据所有者授权的分享者数字身份标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oSharersSetByOwner</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">].</span><span style="color:#A6ACCD;">sharers</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">n</span><span style="color:#89DDFF;">]);</span></span>
<span class="line"><span style="color:#A6ACCD;">             </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="onfailure-1" tabindex="-1">onFailure <a class="header-anchor" href="#onfailure-1" aria-label="Permalink to &quot;onFailure&quot;">​</a></h5><p>此事件在&quot;获取结构数据权限列表&quot;链上操作处理失败，结构数据权限列表未被下载时发生。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onSuccess</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataRightsFetchStatus</span><span style="color:#A6ACCD;"> dRightsFetchStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>dRightsFetchStatus DataRightsFetchStatus</p><p>包含&quot;获取结构数据权限列表&quot;链上操作的当前处理状态信息的对象。</p><p>dRightsFetchStatus中将包含如下返回信息，详细解释请参看DataRightsFetchStatus对象相关描述：</p><p>| errorCode，message |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataRightsFetch</span><span style="color:#A6ACCD;"> oDataRightsFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataRightsFetch</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">DataRightsFetchStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">dRightsFetchStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">//事件触发条件：在&quot;获取结构数据权限列表&quot;链上操作处理失败，结构数据权限列表未被下载。</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> DataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">          System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> DataIDFromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">          System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">查询失败=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> dRightsFetchStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="onerror-2" tabindex="-1">onError <a class="header-anchor" href="#onerror-2" aria-label="Permalink to &quot;onError&quot;">​</a></h5><p>此为事件在DataRightsFetch调用出现异常时发生。事件触发后返回异常信息。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onError</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">FetchException</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">DataRightsFetch</span><span style="color:#A6ACCD;"> oDataRightsFetch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">DataRightsFetch</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onError</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">FetchException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">e</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：DataRightsFetch调用出现异常。并返回异常信息。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> DataIDFromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> DataIDFromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">异常状态描述=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">异常信息=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">exc</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="com-coolawchain-sdk-contract" tabindex="-1">com.coolawchain.sdk.contract <a class="header-anchor" href="#com-coolawchain-sdk-contract" aria-label="Permalink to &quot;com.coolawchain.sdk.contract&quot;">​</a></h2><h3 id="contractcall" tabindex="-1">ContractCall <a class="header-anchor" href="#contractcall" aria-label="Permalink to &quot;ContractCall&quot;">​</a></h3><p>用于进行链上合约调用的操作对象。</p><h4 id="构造函数-4" tabindex="-1">构造函数 <a class="header-anchor" href="#构造函数-4" aria-label="Permalink to &quot;构造函数&quot;">​</a></h4><h5 id="contractcall-frontend-string" tabindex="-1">ContractCall (Frontend, String) <a class="header-anchor" href="#contractcall-frontend-string" aria-label="Permalink to &quot;ContractCall (Frontend, String)&quot;">​</a></h5><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ContractCall</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> frontendServer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>frontendServer Frontend</p><p>前置节点服务器对象。</p><p>businessDomainID String</p><p>设置要访问的业务域标识。初始化时可以为空，后续可通过bizDomain属性赋值。businessDomainID在提交上链交易前必须赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//初始化前置节点对象（即链上操作发送对象）</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--业务系统数字身份标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> systemID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0d64ad368ebc37ddb80424376408cb7bb88ff328</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--业务系统数字身份私钥</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> systemPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8d0422cca53480c6b8d0422cca5341a948e91c50c915a4576c88b53de9c473cc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--前置节点调用接口地址</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> frontendUrl </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://127.1.1.1:9000/fbs/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//创建前置节点对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> oFrontend </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Frontend</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">systemID</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> systemPrivateKey</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> frontendUrl</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//设置要访问的业务域标识</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> businessDomainID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">51eb48b51eb48b2896288021b73bac878c48b289</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">ContractCall</span><span style="color:#A6ACCD;"> oContractCall </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ContractCall</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">oFrontend</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="contractcall-1" tabindex="-1">ContractCall () <a class="header-anchor" href="#contractcall-1" aria-label="Permalink to &quot;ContractCall ()&quot;">​</a></h5><p>构造一个ContractCall对象。后续需赋值要访问前置节点对象和要访问的业务域。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ContractCall</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">();</span></span></code></pre></div><h4 id="属性-4" tabindex="-1">属性 <a class="header-anchor" href="#属性-4" aria-label="Permalink to &quot;属性&quot;">​</a></h4><h5 id="frontend-4" tabindex="-1">frontend <a class="header-anchor" href="#frontend-4" aria-label="Permalink to &quot;frontend&quot;">​</a></h5><p>设置要访问的前置节点服务器对象。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Frontend</span><span style="color:#A6ACCD;"> frontend </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="bizdomain-4" tabindex="-1">bizDomain <a class="header-anchor" href="#bizdomain-4" aria-label="Permalink to &quot;bizDomain&quot;">​</a></h5><p>设置要更新元数据的文件所在链上业务域的唯一标识。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> bizDomain </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="scaddress" tabindex="-1">scAddress <a class="header-anchor" href="#scaddress" aria-label="Permalink to &quot;scAddress&quot;">​</a></h5><p>设置要调用的链上合约地址。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> scAddress </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="callerid" tabindex="-1">callerID <a class="header-anchor" href="#callerid" aria-label="Permalink to &quot;callerID&quot;">​</a></h5><p>设置合约调用者数字身份标识。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> callerID </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> callerID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0d64ad368ebc37ddb80424376408cb7bb88ff328</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    oContractCall</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">callerID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> callerID</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h5 id="schexparam" tabindex="-1">scHexParam <a class="header-anchor" href="#schexparam" aria-label="Permalink to &quot;scHexParam&quot;">​</a></h5><p>设置合约方法调用参数。此属性保存的是经过序列化后的参数体。参数体序列化方式由编写合约的开发者提供规范。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> scHexParam </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="eventcontext-3" tabindex="-1">eventContext <a class="header-anchor" href="#eventcontext-3" aria-label="Permalink to &quot;eventContext&quot;">​</a></h5><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> eventContext </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> set</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//合约调用对应的链外应用系统调用端的参考标识，便于事件中进行后续业务逻辑处理。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> scIDfromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">57bee7e51eb48b2896288021b7374cfc78c0bac8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    oContractCall</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">eventContext </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> scIDfromCaller</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h4 id="方法-4" tabindex="-1">方法 <a class="header-anchor" href="#方法-4" aria-label="Permalink to &quot;方法&quot;">​</a></h4><h5 id="submit-1" tabindex="-1">submit <a class="header-anchor" href="#submit-1" aria-label="Permalink to &quot;submit&quot;">​</a></h5><p>向指定的前置节点服务器提交&quot;合约调用&quot;上链交易请求，开始进行合约调用链上操作。调用此方法，将会通过onTxBlockConfirm、onTxSendSuccess等事件返回链上处理结果。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">submit</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> callerPrivateKey</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>callerPrivateKey String</p><p>设置合约调用者的数字身份私钥。私钥用于对&quot;合约调用&quot;上链交易进行签名确权。</p><p><strong>示例：</strong></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//--链上调用者数字身份私钥</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> callerPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8d0422cca53480c6b8d0422cca5341a948e91c50c915a4576c88b53de9c473cc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//进行合约调用上链操作提交</span></span>
<span class="line"><span style="color:#A6ACCD;">    oContractCall</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">submit</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">callerPrivateKey</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="createtxbody-1" tabindex="-1">createTxBody <a class="header-anchor" href="#createtxbody-1" aria-label="Permalink to &quot;createTxBody&quot;">​</a></h5><p>和前置节点进行交互，生成&quot;合约调用&quot;链上操作对应的上链交易体，以便使用调用者数字身份对应的私钥对上链交易体进行确权签名。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createTxBody</span><span style="color:#89DDFF;">();</span></span></code></pre></div><p><strong>返回</strong></p><p>String</p><p>序列化的&quot;合约调用&quot;上链交易体。</p><p><strong>示例：</strong></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//生成&quot;合约调用&quot;上链交易体</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> scCallTxBody</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> oContractCall</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createTxBody</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//用调用者数字身份对&quot;合约调用&quot;上链交易体进行签名</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> callerPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3161be862236ae966004390908a5facb8f45763e38ce5cfb378e493f91a7873d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//--对&quot;合约调用&quot;上链交易体进行签名，并生成签名结果</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> txSign </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CryptoUtil</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">crypto</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">signature</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">scCallTxBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> callerPrivateKey</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h5 id="submittxbody-1" tabindex="-1">submitTxBody <a class="header-anchor" href="#submittxbody-1" aria-label="Permalink to &quot;submitTxBody&quot;">​</a></h5><p>使用合约调用上链交易体原文和调用者数字身份对上链交易体的签名结果信息，向指定的前置节点服务器提交&quot;合约调用&quot;上链交易请求。调用此方法，将会通过onTxBlockConfirm、onTxSendSuccess等事件返回链上处理结果。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">submitTxBody</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> scCallTxBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> txSign</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p><strong>参数</strong></p><p>scCallTxBody String</p><p>合约调用上链交易体原文</p><p>txSign String</p><p>合约调用上链交易体签名结果信息</p><p><strong>示例：</strong></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//【程序A】准备合约调用上链交易体</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">ContractCall</span><span style="color:#A6ACCD;"> oPrepareSCCallTxBody </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ContractCall</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    oPrepareFileUploadTxBody</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">scAddress </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">88021b73bac8b248b2896278c04a4378962e51eb</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    oPrepareFileUploadTxBody</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">callerID </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0d64ad368ebc37ddb80424376408cb7bb88ff328</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    oContractCall</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">scHexParam </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> SCHexParam</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> scCallTxBody</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> oPrepareSCCallTxBody</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createTxBody</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//【程序B】在外部使用数字身份签名应用进行scCallTxBody签名</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> callerPrivateKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3161be862236ae966004390908a5facb8f45763e38ce5cfb378e493f91a7873d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> txSign </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CryptoUtil</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">crypto</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">signature</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">scCallTxBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> callerPrivateKey</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//【程序A】提交合约调用上链交易，并跟踪链上处理状态</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">ContractCall</span><span style="color:#A6ACCD;"> oContractCall </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">FileUpload</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">frontendServer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> businessDomainID</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    oContractCall</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">eventContext </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> scIDfromCaller</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    oContractCall</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">submitTxBody</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">scCallTxBody</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> txSign</span><span style="color:#89DDFF;">);</span></span></code></pre></div><h4 id="事件-3" tabindex="-1">事件 <a class="header-anchor" href="#事件-3" aria-label="Permalink to &quot;事件&quot;">​</a></h4><h5 id="ontxblockconfirm-1" tabindex="-1">onTxBlockConfirm <a class="header-anchor" href="#ontxblockconfirm-1" aria-label="Permalink to &quot;onTxBlockConfirm&quot;">​</a></h5><p>此事件在合约调用成功，并获得落块确认时发生。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxBlockConfirm</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ContractCallStatus</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>scCallStatus ContractCallStatus</p><p>包含&quot;合约调用&quot;链上操作的当前处理状态信息的对象。</p><p>scCallStatus中将包含如下返回信息，详细解释请参看ContractCallStatus对象相关描述：</p><p>| status，errorCode，message，scHexReturnData，txHash，txExecTimestamp，blockHash，blockedTimestamp，blockHeight |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">ContractCall</span><span style="color:#A6ACCD;"> oContractCall </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ContractCall</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxBlockConfirm</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ContractCallStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">scCallStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：合约调用成功，并获得落块确认。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">SCTxBlockInfo</span><span style="color:#A6ACCD;"> oSCTxBlockInfo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txBlockData</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">合约调用返回结果=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">scHexReturnData</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> scIDfromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> scIDfromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="ontxblkcfmfailure-1" tabindex="-1">onTxBlkCfmFailure <a class="header-anchor" href="#ontxblkcfmfailure-1" aria-label="Permalink to &quot;onTxBlkCfmFailure&quot;">​</a></h5><p>此事件在合约调用上链交易落块确认失败，合约调用影响的链上数据变化被链回滚时发生。事件触发后，会返回错误信息。合约调用上链交易请求需重新提交。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxBlockCfmFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ContractCallStatus</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>scCallStatus ContractCallStatus</p><p>包含&quot;合约调用&quot;链上操作的当前处理状态信息的对象。</p><p>scCallStatus中将包含如下返回信息，详细解释请参看ContractCallStatus对象相关描述：</p><p>| status，errorCode，message，txHash，txExecTimestamp，blockHash，blockedTimestamp，blockHeight |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">ContractCall</span><span style="color:#A6ACCD;"> oContractCall </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ContractCall</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxBlockCfmFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ContractCallStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">scCallStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：合约调用上链交易落块确认失败，合约调用影响的链上数据变化被链回滚。</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发后，会返回错误信息。合约调用上链交易请求需重新提交。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">SCTxBlockInfo</span><span style="color:#A6ACCD;"> oSCTxBlockInfo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txBlockData</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">合约调用上链交易Hash =</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oSCTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txHash</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">合约调用上链交易落块确认失败的返回结果=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> scIDfromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> scIDfromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="ontxsendsuccess-1" tabindex="-1">onTxSendSuccess <a class="header-anchor" href="#ontxsendsuccess-1" aria-label="Permalink to &quot;onTxSendSuccess&quot;">​</a></h5><p>此事件在合约调用上链交易发送成功，等待区块链执行处理时发生。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxSendSuccess</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ContractCallStatus</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>scCallStatus ContractCallStatus</p><p>包含&quot;合约调用&quot;链上操作的当前处理状态信息的对象。</p><p>scCallStatus中将包含如下返回信息，详细解释请参看ContractCallStatus对象相关描述：</p><p>| status，errorCode，message，txHash |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">ContractCall</span><span style="color:#A6ACCD;"> oContractCall </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ContractCall</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxSendSuccess</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ContractCallStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">scCallStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：合约调用上链交易发送成功，等待区块链执行处理。 </span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">SCTxBlockInfo</span><span style="color:#A6ACCD;"> oSCTxBlockInfo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txBlockData</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">合约调用上链交易Hash =</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oSCTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txHash</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="ontxsendfailure-1" tabindex="-1">onTxSendFailure <a class="header-anchor" href="#ontxsendfailure-1" aria-label="Permalink to &quot;onTxSendFailure&quot;">​</a></h5><p>此事件在合约调用上链交易发送失败时发生。合约调用上链交易请求需重新提交。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxSendFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ContractCallStatus</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>scCallStatus ContractCallStatus</p><p>包含&quot;合约调用&quot;链上操作的当前处理状态信息的对象。</p><p>scCallStatus中将包含如下返回信息，详细解释请参看ContractCallStatus对象相关描述：</p><p>| errorCode，message |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">ContractCall</span><span style="color:#A6ACCD;"> oContractCall </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ContractCall</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxSendFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ContractCallStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">scCallStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：合约调用上链交易发送失败。</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">合约调用上链交易发送失败的返回结果=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="ontxexecsuccess-1" tabindex="-1">onTxExecSuccess <a class="header-anchor" href="#ontxexecsuccess-1" aria-label="Permalink to &quot;onTxExecSuccess&quot;">​</a></h5><p>此事件在合约调用上链交易执行成功，等待落块确认时发生。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxExecSuccess</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ContractCallStatus</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>scCallStatus ContractCallStatus</p><p>包含&quot;合约调用&quot;链上操作的当前处理状态信息的对象。</p><p>scCallStatus中将包含如下返回信息，详细解释请参看ContractCallStatus对象相关描述：</p><p>| status，errorCode，message，scHexReturnData，txHash，txExecTimestamp，blockHash，blockedTimestamp，blockHeight |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">ContractCall</span><span style="color:#A6ACCD;"> oContractCall </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ContractCall</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxExecSuccess</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ContractCallStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">scCallStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：合约调用上链交易执行成功，等待落块确认。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">SCTxBlockInfo</span><span style="color:#A6ACCD;"> oSCTxBlockInfo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txBlockData</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">合约调用返回结果=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">scHexReturnData</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> scIDfromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> scIDfromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">合约调用上链交易Hash=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oSCTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txHash</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">交易执行时间戳=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oSCTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txExecTimestamp</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">交易所在区块hash=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oSCTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">blockHash</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">交易所在区块生成时间戳</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oSCTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">blockedTimestamp</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">交易所在区块高度=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oSCTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">blockHeight</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="ontxexecfailure-1" tabindex="-1">onTxExecFailure <a class="header-anchor" href="#ontxexecfailure-1" aria-label="Permalink to &quot;onTxExecFailure&quot;">​</a></h5><p>此事件在合约调用上链交易执行失败，合约调用影响的链上数据变化未上链生效时发生。事件触发后会返回错误信息。文件元数据上链交易请求需重新提交。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxExecFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ContractCallStatus</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>参数</p><p>scCallStatus ContractCallStatus</p><p>包含&quot;合约调用&quot;链上操作的当前处理状态信息的对象。</p><p>scCallStatus中将包含如下返回信息，详细解释请参看ContractCallStatus对象相关描述：</p><p>| status，errorCode，message，txHash，txExecTimestamp，blockHash，blockedTimestamp，blockHeight |</p><p>context Object</p><p>设置需要传入事件中的业务逻辑信息，便于事件中进行后续业务逻辑处理。如果没有可传入的信息，此参数可以不用赋值。</p><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">ContractCall</span><span style="color:#A6ACCD;"> oContractCall </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ContractCall</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onTxExecFailure</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ContractCallStatus</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">scCallStatus</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：合约调用上链交易执行失败，合约调用影响的链上数据变化未上链生效。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">SCTxBlockInfo</span><span style="color:#A6ACCD;"> oSCTxBlockInfo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txBlockData</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> scIDfromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> scIDfromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">结构数据保存上链交易Hash =</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> oSCTxBlockInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txHash</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链上执行失败的返回结果=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> scCallStatus</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div><h5 id="onerror-3" tabindex="-1">onError <a class="header-anchor" href="#onerror-3" aria-label="Permalink to &quot;onError&quot;">​</a></h5><p>此为事件在ContractCall调用出现异常时发生。事件触发后返回异常信息。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onError</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">TxException</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>示例：</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">ContractCall</span><span style="color:#A6ACCD;"> oContractCall </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ContractCall</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onError</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">TxException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">e</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">context</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">           </span><span style="color:#676E95;font-style:italic;">//事件触发条件：ContractCall调用出现异常。并返回异常信息。</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> scIDfromCaller </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">链外应用系统调用端的唯一标识=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> scIDfromCaller</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">异常状态描述=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">           System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">异常信息=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">exc</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span></code></pre></div>`,504),t=[p];function e(c,r,D,y,C,A){return a(),n("div",null,t)}const d=s(o,[["render",e]]);export{i as __pageData,d as default};
